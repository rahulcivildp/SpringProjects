	var extraImagesCount = 0;
	
	dropDownBrands = $("#brands");
	dropDownCategories = $("#categories");
	
	$(document).ready(function(){
		
		$("#shortDescription").richText();
		$("#fullDescription").richText();
		
		dropDownBrands.change(function(){
			dropDownCategories.empty();
			getCategories();
		});
		
		getCategories();
		
		
		$("input[name='extraImage']").each(function(index){
			extraImagesCount++;
			
			$(this).change(function(){
				showImageExtraThumbnail(this, index);
			});
		});
		
	});
	
	function showImageExtraThumbnail(fileInput, index) {
		var file = fileInput.files[0];
		var reader = new FileReader();
		reader.onload = function(e) {
			$("#extraThumbnail-" + index).attr("src", e.target.result);
		}
		
		reader.readAsDataURL(file);
		if (index >= extraImagesCount - 1) {
			addExtraImageSection(index + 1);
		}
	}
	
	function addExtraImageSection(index) {
		
		htmlAdd = `<div class="col border m-3 p-2" id="divExtraImage-${index}">
				<div id="extraImageHeader-${index}"><label class="mb-3">Extra Images: ${index + 1}</label></div>
				<div>
					<input type="hidden" th:field="*{images}">
					<img class="img-thumbnail img-fluid" id="extraThumbnail-${index}" src="${imageThumbnailSRC}" alt="Photo ${index + 1} Preview" style="max-width: 25% !important;"/>
				</div>
				<div class="mt-3">
					<input type="file" name="extraImage" id="extraImage" accept="image/png, image/jpeg" class="mb-2" onchange="showImageExtraThumbnail(this, ${index})"/>
				</div>
			</div>`;	
			
		htmlLinkRemove = `<a class="btn fa fa-solid fa-circle-xmark fa-2x float-right" href="javascript:removeExtraImage(${index - 1})" title="Remove this image"></a>`;
		
		$("#divProductImages").append(htmlAdd);
		
		$("#extraImageHeader-" + (index - 1)).append(htmlLinkRemove);
		
		extraImagesCount++;
	}
	
	function removeExtraImage(index) {
		$("#divExtraImage-" + index).remove();
	}
	
	function getCategories() {
		brandId = dropDownBrands.val();
		url = brandModuleURL + "/" + brandId + "/categories";
		
		$.get(url, function(responseJson) {
			$.each(responseJson, function(index, category) {
				$("<option>").val(category.id).text(category.name).appendTo(dropDownCategories);
			});
		})
	};
	
	function checkNameUnique(form) {
		
		productName = $("#name").val();
		productId = $("#id").val();
		csrfVal = $("input[name='_csrf']").val();
		params = {id: productId, name: productName, _csrf: csrfVal};
			
		$.post(checkedURL, params, function(response) {
			if (response == "OK") {
				form.submit();
			} else if (response == "Duplicate") {
				showModelDialogue("Warning! ", response + " is provided: " + productName);
			} else {
				showModelDialogue("Error", "Unknown response from server...");
			}
		}).fail(function(){
			showModelDialogue("Warning! ", "Unknown response from the server!!!");
		});
		
		return false;
	};
	
	function showModelDialogue(title, message) {
		if (!message.isEmpty()) {
			$("#modalTitle").text(title);
			$("#modalBody").text(message);
			$("#modalDialogue").modal();
		} 
	};/**
 * 
 */